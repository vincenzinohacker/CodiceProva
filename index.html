<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Love & Vibes Analyzer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap');

        body {
            font-family: 'Poppins', sans-serif;
        }

        .glass {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .heart-beat {
            animation: beat 1s infinite alternate;
        }

        @keyframes beat {
            from {
                transform: scale(1);
            }

            to {
                transform: scale(1.1);
            }
        }

        /* Animazione per i risultati */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fade-in {
            animation: fadeIn 0.5s ease-out forwards;
        }
    </style>
</head>

<body
    class="bg-gradient-to-br from-purple-600 via-pink-500 to-red-500 min-h-screen flex items-center justify-center p-4">

    <div class="glass max-w-md w-full rounded-3xl shadow-2xl overflow-hidden relative">
        <!-- Decorazioni sfondo -->
        <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-yellow-400 via-red-500 to-pink-500"></div>

        <div class="p-8 text-center">
            <h1 class="text-3xl font-extrabold text-gray-800 mb-2">ğŸ’˜ Love & Vibes</h1>
            <p class="text-gray-500 text-sm mb-6">L'oracolo digitale non sbaglia mai.</p>

            <!-- Input Section -->
            <div class="space-y-4 text-left" id="inputSection">
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase tracking-wider mb-1 ml-1">Il nome di
                        lei</label>
                    <input type="text" id="herName" placeholder="Es. Giulia"
                        class="w-full bg-gray-100 border-2 border-transparent focus:border-pink-500 focus:bg-white rounded-xl px-4 py-3 outline-none transition-all font-semibold text-gray-700">
                </div>

                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase tracking-wider mb-1 ml-1">La sua data
                        di nascita</label>
                    <input type="date" id="herBirthDate"
                        class="w-full bg-gray-100 border-2 border-transparent focus:border-pink-500 focus:bg-white rounded-xl px-4 py-3 outline-none transition-all font-semibold text-gray-700">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase tracking-wider mb-1 ml-1">Il tuo
                        nome</label>
                    <input type="text" id="yourName" placeholder="Es. Marco"
                        class="w-full bg-gray-100 border-2 border-transparent focus:border-purple-500 focus:bg-white rounded-xl px-4 py-3 outline-none transition-all font-semibold text-gray-700">
                </div>
                <div>
                    <label class="block text-xs font-bold text-gray-400 uppercase tracking-wider mb-1 ml-1">La tua data
                        di nascita</label>
                    <input type="date" id="yourBirthDate"
                        class="w-full bg-gray-100 border-2 border-transparent focus:border-purple-500 focus:bg-white rounded-xl px-4 py-3 outline-none transition-all font-semibold text-gray-700">
                </div>

                <button onclick="analizza()"
                    class="w-full bg-black text-white font-bold py-4 rounded-xl mt-4 hover:scale-[1.02] active:scale-95 transition-transform shadow-lg flex items-center justify-center gap-2">
                    <i class="fas fa-magic"></i> Analizza Vibes
                </button>
            </div>

            <!-- Loading Spinner (Nascosto) -->
            <div id="loading" class="hidden py-10">
                <i class="fas fa-heart text-5xl text-red-500 heart-beat"></i>
                <p class="mt-4 text-gray-600 font-medium">Calcolo astri e algoritmi...</p>
            </div>

            <!-- Results Section (Nascosto) -->
            <div id="resultSection" class="hidden mt-6 text-left animate-fade-in">

                <!-- Card Lei -->
                <div class="bg-pink-50 rounded-2xl p-5 border border-pink-100 mb-4">
                    <h3 class="font-bold text-pink-600 text-lg flex items-center gap-2">
                        <i class="fas fa-user-circle"></i> <span id="resHerName">Lei</span> (<span id="resHerZodiac"
                            class="text-sm text-pink-400"></span>) Ã¨ tipo...
                    </h3>
                    <ul id="traitsList" class="mt-3 space-y-2 text-sm text-gray-700 font-medium">
                        <!-- Traits injected here -->
                    </ul>
                </div>

                <!-- Flags Section -->
                <div id="flagsSection"></div>

                <!-- Pickup Line Section -->
                <div class="mt-4 bg-yellow-50 p-4 rounded-xl border border-yellow-200 relative overflow-hidden">
                    <div class="absolute -right-4 -top-4 opacity-10 text-6xl">ğŸ’¡</div>
                    <p class="text-xs text-yellow-600 font-bold uppercase tracking-wider mb-2">Rimorchio Assistito (IA)
                    </p>
                    <p id="pickupLine" class="text-gray-800 italic font-medium text-center text-sm">...</p>
                </div>

                <!-- Card CompatibilitÃ  -->
                <div
                    class="bg-gradient-to-r from-purple-100 to-indigo-100 rounded-2xl p-5 border border-purple-200 text-center">
                    <h3 class="text-xs font-bold text-purple-400 uppercase tracking-widest mb-2">CompatibilitÃ  Totale
                    </h3>

                    <div class="flex justify-center items-center gap-2 mb-2 text-sm text-gray-600 font-semibold">
                        <span><i class="fas fa-venus text-pink-500"></i> <span id="displayHerZodiac"></span></span>
                        <span>âš¡</span>
                        <span><i class="fas fa-mars text-blue-500"></i> <span id="displayYourZodiac"></span></span>
                    </div>

                    <div
                        class="text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600 mb-2">
                        <span id="score">0</span>%
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5 mb-2 overflow-hidden">
                        <div id="progressBar" class="bg-gradient-to-r from-purple-500 to-pink-500 h-2.5 rounded-full"
                            style="width: 0%"></div>
                    </div>
                    <p id="verdict" class="text-sm font-bold text-gray-600 italic">"..."</p>
                </div>

                <button onclick="shareResult()"
                    class="w-full mt-4 bg-green-500 text-white font-bold py-3 rounded-xl hover:bg-green-600 transition-colors shadow-md flex items-center justify-center gap-2">
                    <i class="fab fa-whatsapp"></i> Condividi Risultato
                </button>

                <button onclick="reset()"
                    class="w-full mt-6 text-gray-400 text-sm hover:text-gray-600 underline">Riprova con
                    un'altra</button>
            </div>

        </div>
    </div>

    <script>
        // Database di "Vibes" semi-serie e divertenti
        const possibleTraits = [
            "Ordina sushi ma mangia solo gli edamame ğŸ£",
            "Ti risponde dopo 3 ore ma Ã¨ online su IG ğŸ“±",
            "Mette like alle storie del suo ex (per sbaglio) ğŸ’€",
            "Ascolta solo musica triste quando piove ğŸŒ§ï¸",
            "Crede fermamente nell'oroscopo ğŸ”®",
            "Ha 5 personalitÃ  diverse in base all'outfit ğŸ‘—",
            "Non sa parcheggiare ma ha una macchina enorme ğŸš—",
            "Pianifica il matrimonio al primo appuntamento ğŸ’",
            "Ti ruba la felpa e non la ridÃ  piÃ¹ ğŸ§¥",
            "Fa screenshot a tutte le chat ğŸ‘€",
            "Ãˆ perennemente a dieta ma mangia il tuo dolce ğŸ°",
            "Dice 'sto arrivando' ma sta ancora facendo la doccia ğŸš¿",
            "Shopping compulsivo su Shein/Zara ğŸ›ï¸",
            "Ha un account TikTok segreto dove balla ğŸ’ƒ",
            "Troppo bella per essere vera (e lo sa) âœ¨",
            "Coffee addicted â˜•",
            "Si veste meglio di te anche in pigiama ğŸ‘‘",
            "Ride alle battute squallide ğŸ˜‚"
        ];

        const redFlags = [
            "Mastica a bocca aperta ğŸš©",
            "Parla solo di sÃ© ğŸš©",
            "Non ti chiede mai 'come stai?' ğŸš©",
            "Tratta male i camerieri ğŸš©",
            "Ha ancora le foto con l'ex sul profilo ğŸš©",
            "Non gli/le piacciono i cani ğŸš©",
            "Non mette la freccia in rotonda ğŸš©",
            "Scrive 'pk' invece di 'perchÃ©' ğŸš©"
        ];

        const greenFlags = [
            "Ti porta il caffÃ¨ a letto ğŸ’š",
            "Risponde subito ai messaggi ğŸ’š",
            "Va d'accordo con tua mamma ğŸ’š",
            "Ti supporta nei tuoi sogni ğŸ’š",
            "Cucina da Dio ğŸ’š",
            "Ti fa ridere fino alle lacrime ğŸ’š",
            "Si ricorda i dettagli che racconti ğŸ’š",
            "Profuma sempre di buono ğŸ’š"
        ];

        const zodiacPickupLines = {
            'aries': "Sei un Ariete? PerchÃ© sei un fuoco che non riesco a spegnere. ğŸ”¥",
            'taurus': "Sei Toro? PerchÃ© con te farei maratona di serie TV e cibo per sempre. ğŸ•",
            'gemini': "Sei Gemelli? Meno male, perchÃ© mi piaci in tutte le tue versioni. ğŸ‘¯â€â™€ï¸",
            'cancer': "Sei Cancro? PerchÃ© mi sento a casa quando sono con te. ğŸ ",
            'leo': "Sei Leone? PerchÃ© brilli piÃ¹ del sole (e lo sai). â˜€ï¸",
            'virgo': "Sei Vergine? PerchÃ© sei l'unica cosa perfetta nella mia vita disordinata. ğŸ§¹",
            'libra': "Sei Bilancia? PerchÃ© sei l'equilibrio che mi mancava. âš–ï¸",
            'scorpio': "Sei Scorpione? PerchÃ© sei un mistero che voglio risolvere. ğŸ•µï¸â€â™‚ï¸",
            'sagittarius': "Sei Sagittario? PerchÃ© con te andrei in capo al mondo. ğŸŒ",
            'capricorn': "Sei Capricorno? PerchÃ© sei un investimento sicuro per il mio cuore. ğŸ“ˆ",
            'aquarius': "Sei Acquario? PerchÃ© sei fuori da questo mondo. ğŸ‘½",
            'pisces': "Sei Pesci? PerchÃ© mi sono perso nei tuoi occhi (e nel tuo delirio). ğŸŒŠ"
        };

        // Funzione per generare un numero "fisso" da una stringa
        // Serve per dare sempre lo stesso risultato per lo stesso nome
        function stringToHash(string) {
            let hash = 0;
            if (string.length == 0) return hash;
            for (let i = 0; i < string.length; i++) {
                char = string.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash;
            }
            return Math.abs(hash);
        }

        function getZodiacSign(day, month) {
            const zodiacSigns = {
                'capricorn': 'â™‘ Capricorno',
                'aquarius': 'â™’ Acquario',
                'pisces': 'â™“ Pesci',
                'aries': 'â™ˆ Ariete',
                'taurus': 'â™‰ Toro',
                'gemini': 'â™Š Gemelli',
                'cancer': 'â™‹ Cancro',
                'leo': 'â™Œ Leone',
                'virgo': 'â™ Vergine',
                'libra': 'â™ Bilancia',
                'scorpio': 'â™ Scorpione',
                'sagittarius': 'â™ Sagittario'
            };

            if ((month == 1 && day <= 19) || (month == 12 && day >= 22)) return zodiacSigns['capricorn'];
            if ((month == 1 && day >= 20) || (month == 2 && day <= 18)) return zodiacSigns['aquarius'];
            if ((month == 2 && day >= 19) || (month == 3 && day <= 20)) return zodiacSigns['pisces'];
            if ((month == 3 && day >= 21) || (month == 4 && day <= 19)) return zodiacSigns['aries'];
            if ((month == 4 && day >= 20) || (month == 5 && day <= 20)) return zodiacSigns['taurus'];
            if ((month == 5 && day >= 21) || (month == 6 && day <= 20)) return zodiacSigns['gemini'];
            if ((month == 6 && day >= 21) || (month == 7 && day <= 22)) return zodiacSigns['cancer'];
            if ((month == 7 && day >= 23) || (month == 8 && day <= 22)) return zodiacSigns['leo'];
            if ((month == 8 && day >= 23) || (month == 9 && day <= 22)) return zodiacSigns['virgo'];
            if ((month == 9 && day >= 23) || (month == 10 && day <= 22)) return zodiacSigns['libra'];
            if ((month == 10 && day >= 23) || (month == 11 && day <= 21)) return zodiacSigns['scorpio'];
            if ((month == 11 && day >= 22) || (month == 12 && day <= 21)) return zodiacSigns['sagittarius'];

            return "â“ Mistero";
        }

        function getZodiacKey(day, month) {
            if ((month == 1 && day <= 19) || (month == 12 && day >= 22)) return 'capricorn';
            if ((month == 1 && day >= 20) || (month == 2 && day <= 18)) return 'aquarius';
            if ((month == 2 && day >= 19) || (month == 3 && day <= 20)) return 'pisces';
            if ((month == 3 && day >= 21) || (month == 4 && day <= 19)) return 'aries';
            if ((month == 4 && day >= 20) || (month == 5 && day <= 20)) return 'taurus';
            if ((month == 5 && day >= 21) || (month == 6 && day <= 20)) return 'gemini';
            if ((month == 6 && day >= 21) || (month == 7 && day <= 22)) return 'cancer';
            if ((month == 7 && day >= 23) || (month == 8 && day <= 22)) return 'leo';
            if ((month == 8 && day >= 23) || (month == 9 && day <= 22)) return 'virgo';
            if ((month == 9 && day >= 23) || (month == 10 && day <= 22)) return 'libra';
            if ((month == 10 && day >= 23) || (month == 11 && day <= 21)) return 'scorpio';
            if ((month == 11 && day >= 22) || (month == 12 && day <= 21)) return 'sagittarius';
            return 'aries'; // Default
        }

        function analizza() {
            const herName = document.getElementById('herName').value.trim();
            const herBirthDateValue = document.getElementById('herBirthDate').value;
            const yourName = document.getElementById('yourName').value.trim();
            const yourBirthDateValue = document.getElementById('yourBirthDate').value;

            if (!herName || !yourName || !herBirthDateValue || !yourBirthDateValue) {
                alert("Devi inserire TUTTI i dati! Date comprese! ğŸ“…");
                return;
            }

            // Lei
            const dateObjHer = new Date(herBirthDateValue);
            const herZodiac = getZodiacSign(dateObjHer.getDate(), dateObjHer.getMonth() + 1);
            const herZodiacKey = getZodiacKey(dateObjHer.getDate(), dateObjHer.getMonth() + 1);

            // Lui
            const dateObjYou = new Date(yourBirthDateValue);
            const yourZodiac = getZodiacSign(dateObjYou.getDate(), dateObjYou.getMonth() + 1);

            // UI Switch
            document.getElementById('inputSection').classList.add('hidden');
            document.getElementById('loading').classList.remove('hidden');

            // Simula attesa calcolo
            setTimeout(() => {
                showResults(herName, herZodiac, herZodiacKey, yourName, yourZodiac);
            }, 2000);
        }

        function showResults(herName, herZodiac, herZodiacKey, yourName, yourZodiac) {
            document.getElementById('loading').classList.add('hidden');
            document.getElementById('resultSection').classList.remove('hidden');

            document.getElementById('resHerName').innerText = herName;
            document.getElementById('resHerZodiac').innerText = herZodiac;

            document.getElementById('displayHerZodiac').innerText = herZodiac;
            document.getElementById('displayYourZodiac').innerText = yourZodiac;

            // 1. Genera caratteristiche basate sul nome di lei
            const hashLei = stringToHash(herName.toLowerCase());
            const list = document.getElementById('traitsList');
            list.innerHTML = '';

            // Seleziona 3 caratteristiche "pseudo-random" ma fisse per quel nome
            const index1 = hashLei % possibleTraits.length;
            const index2 = (hashLei * 7) % possibleTraits.length;
            const index3 = (hashLei * 13) % possibleTraits.length;

            const selectedTraits = [
                possibleTraits[index1],
                possibleTraits[index2 === index1 ? (index2 + 1) % possibleTraits.length : index2],
                possibleTraits[index3]
            ];

            selectedTraits.forEach(trait => {
                const li = document.createElement('li');
                li.innerHTML = `<i class="fas fa-check text-pink-400 mr-2"></i> ${trait}`;
                list.appendChild(li);
            });

            // RED FLAG / GREEN FLAG
            const indexRed = (hashLei * 2) % redFlags.length;
            const indexGreen = (hashLei * 3) % greenFlags.length;

            const flagsDiv = document.getElementById('flagsSection');
            flagsDiv.innerHTML = `
                <div class="mt-4 grid grid-cols-2 gap-3">
                    <div class="bg-red-50 p-3 rounded-xl border border-red-200">
                        <p class="text-xs text-red-500 font-bold uppercase mb-1">Red Flag ğŸš©</p>
                        <p class="text-sm text-gray-700 font-medium">${redFlags[indexRed]}</p>
                    </div>
                     <div class="bg-green-50 p-3 rounded-xl border border-green-200">
                        <p class="text-xs text-green-500 font-bold uppercase mb-1">Green Flag ğŸ’š</p>
                        <p class="text-sm text-gray-700 font-medium">${greenFlags[indexGreen]}</p>
                    </div>
                </div>
            `;

            // PICKUP LINE
            const pickupLine = zodiacPickupLines[herZodiacKey];
            document.getElementById('pickupLine').innerText = `"${pickupLine}"`;


            // 2. Calcola compatibilitÃ  basata sulla combinazione dei nomi
            const combinedHash = stringToHash((herName + yourName).toLowerCase());
            const percentage = (combinedHash % 101); // 0 a 100

            // Anima il numero
            animateValue("score", 0, percentage, 1500);
            document.getElementById('progressBar').style.width = `${percentage}%`;

            // Verdetto
            let verdict = "";
            if (percentage > 90) verdict = "ANIME GEMELLE! Sposatevi domani. ğŸ’";
            else if (percentage > 70) verdict = "C'Ã¨ chimica potente. ğŸ”¥";
            else if (percentage > 50) verdict = "Potrebbe funzionare, con impegno. ğŸ¤”";
            else if (percentage > 30) verdict = "Zona Friendzone pericolosa. âš ï¸";
            else verdict = "Scappa finchÃ© sei in tempo. ğŸƒâ€â™‚ï¸";

            document.getElementById('verdict').innerText = verdict;
        }

        function animateValue(id, start, end, duration) {
            const obj = document.getElementById(id);
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                obj.innerHTML = Math.floor(progress * (end - start) + start);
                if (progress < 1) {
                    window.requestAnimationFrame(step);
                }
            };
            window.requestAnimationFrame(step);
        }

        function shareResult() {
            const herName = document.getElementById('herName').value.trim();
            const herBirthDateValue = document.getElementById('herBirthDate').value;
            const yourName = document.getElementById('yourName').value.trim();
            const yourBirthDateValue = document.getElementById('yourBirthDate').value;

            // Encode params
            const params = new URLSearchParams({
                h: herName,
                d: herBirthDateValue,
                y: yourName,
                yd: yourBirthDateValue
            });

            const shareUrl = `${window.location.origin}${window.location.pathname}?${params.toString()}`;

            const score = document.getElementById('score').innerText;
            const verdict = document.getElementById('verdict').innerText;
            const text = `Ho calcolato la compatibilitÃ  su Love & Vibes! ğŸ’˜\nRisultato: ${score}%\nVerdetto: ${verdict}\n\nScopri il tuo qui: ${shareUrl}`;

            if (navigator.share) {
                navigator.share({
                    title: 'Love & Vibes Result',
                    text: text,
                    url: shareUrl,
                })
                    .then(() => console.log('Successful share'))
                    .catch((error) => console.log('Error sharing', error));
            } else {
                // Fallback: copia negli appunti
                navigator.clipboard.writeText(text).then(() => {
                    alert("Link copiato! ğŸ“‹\n" + shareUrl);
                });
            }
        }

        function reset() {
            // Clear URL params without reload
            window.history.pushState({}, document.title, window.location.pathname);

            document.getElementById('resultSection').classList.add('hidden');
            document.getElementById('inputSection').classList.remove('hidden');
            document.getElementById('herName').value = '';
            // keep other inputs maybe? nah clear her name is enough
        }

        // Check for URL params on load
        window.addEventListener('load', () => {
            const params = new URLSearchParams(window.location.search);
            const h = params.get('h');
            const d = params.get('d');
            const y = params.get('y');
            const yd = params.get('yd');

            if (h && d && y && yd) {
                document.getElementById('herName').value = h;
                document.getElementById('herBirthDate').value = d;
                document.getElementById('yourName').value = y;
                document.getElementById('yourBirthDate').value = yd;
                // Auto run
                analizza();
            }
        });

    </script>
</body>

</html>